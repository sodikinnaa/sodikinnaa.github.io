<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, shrink-to-fit=no" />
  <title>Blog | Sodikin</title>
  <meta name="description" id="meta-desc" content="Kumpulan artikel sederhana, catatan coding, dan sharing insight teknologi dari Sodikin.">
  <!-- Add a favicon to avoid GET /favicon.ico 404 error -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%232563eb'/%3E%3Ctext x='16' y='22' font-size='16' text-anchor='middle' fill='white' font-family='Arial,sans-serif'%3EA%3C/text%3E%3C/svg%3E">
  <!-- Bootstrap 4, Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue";
      background: #f7f8fb;
      color: #23272f;
      min-height: 100vh;
    }
    .navbar {
      font-size: 1.08rem;
      letter-spacing: 0.03em;
    }
    .navbar-brand {
      font-weight: 700;
      letter-spacing: 1px;
      color: #2563eb !important;
    }
    .navbar-light .navbar-nav .nav-link {
      color: #23272f;
      font-weight: 500;
      margin-right: 0.4em;
      transition: color 0.13s;
    }
    .navbar-light .navbar-nav .active,
    .navbar-light .navbar-nav .nav-link:focus,
    .navbar-light .navbar-nav .nav-link:hover {
      color: #2563eb;
    }
    /* Blog header style baru agar tetap ada dan konsisten */
    header.blog-header {
      background: linear-gradient(90deg,#0ea5e9, #2563eb);
      color: #fff;
      padding: 34px 0 24px 0;
    }
    @media (max-width: 576px){
      header.blog-header {
        padding-top: 24px;
        padding-bottom: 16px;
      }
    }
    .blog-title {
      font-size: 1.75rem;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 0.18em;
      line-height: 1.17;
    }
    .blog-desc {
      color: #e1edf4;
      font-size: 1.01rem;
      margin-bottom: 0;
      opacity: .87;
    }
    main {
      max-width: 900px;
      margin: 36px auto;
      padding: 0 16px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(285px,1fr));
      gap: 22px;
    }
    .card.blog-card {
      background: #fff;
      border-radius: 17px;
      border: none;
      box-shadow: 0 6px 25px 0 rgba(54,75,101,0.10);
      padding: 0;
      overflow: hidden;
      transition: box-shadow 0.15s;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    .card.blog-card:hover {
      box-shadow: 0 13px 32px 0 rgba(54,85,170,0.17);
    }
    .blog-card-body {
      flex:1;
      padding: 22px 22px 12px 22px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .article-link {
      color: inherit;
      text-decoration: none;
      display: block;
      height: 100%;
    }
    .meta {
      color: #6b7280;
      font-size: 13px;
      margin-bottom: 8px;
      margin-top: 3px;
    }
    .blog-card-footer {
      padding: 0 22px 18px 22px;
    }
    .blog-card-read {
      color: #1d4ed8;
      font-weight: 600;
      letter-spacing: .3px;
      font-size: 1.01em;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .blog-h2 {
      margin: 0 0 14px 0;
      font-size: 1.28rem;
      font-weight: 700;
      letter-spacing: 0.3px;
      color: #23272f;
    }
    #search {
      border-radius: 10px;
      border: 1px solid #e6e9ef;
      padding: 9px 13px;
      font-size: 1rem;
      width: 220px;
      max-width: 100%;
      background: #fafdff;
      transition: border 0.13s;
    }
    #search:focus { border-color: #2563eb; outline: none; }
    .article-content {
      background: #fff;
      border-radius: 17px;
      box-shadow: 0 8px 20px rgba(12,18,28,0.08);
      padding: 36px 26px 24px 26px;
      max-width: 820px;
      margin: 0 auto 28px auto;
    }
    .back {
      display: inline-flex;
      align-items: center;
      margin-bottom: 22px;
      font-weight: 500;
      letter-spacing: .1px;
      color: #2563eb;
      background: #ecf2fe;
      padding: 7px 13px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 1.01rem;
      transition: background 0.13s;
    }
    .back:hover { background: #dae5fa; color: #174fd2;}
    pre {
      background: #0b1220;
      color:#e6eef8;
      padding:13px 16px;
      border-radius:10px;
      overflow-x:auto;
      font-size:1rem;
      margin-bottom: 16px;
    }
    code.inline {
      background:#eef2ff;
      padding:2.5px 7px;
      border-radius:6px;
      font-size:0.96em;
    }
    h1, h2, h3 {
      margin-top: 1.6em;
      margin-bottom: 0.6em;
      font-weight: 700;
      color: #1d263b;
    }
    h2 {
      font-size: 1.4rem;
      margin-top: 1.35em;
    }
    h3 {
      font-size: 1.16rem;
      margin-top: 1.2em;
    }
    p {
      line-height: 1.70;
      color: #23272f;
      margin: 0.75em 0;
      font-size: 1.01rem;
    }
    ul {
      margin: 8px 0 8px 26px;
    }
    .notfound {
      padding: 23px 19px;
      background: #fff6f6;
      border: 1px solid #ffd6d6;
      color: #9b1c1c;
      border-radius: 8px;
      margin-bottom: 34px;
      font-size: 1.05em;
    }
    footer {
      background: #2563eb;
      color: #e6eef8;
      padding: 30px 0;
      font-size: 1.01rem;
      letter-spacing: 0.1px;
      margin-top: 64px;
      box-shadow: 0 -2px 24px 0 rgba(26,49,105,0.03);
    }
    .footer-credit {
      opacity: .90;
      font-size: 0.98em;
    }
    @media (max-width: 700px) {
      main { padding:0 7px;}
      .article-content { padding:20px 7px;}
      .blog-card-body, .blog-card-footer { padding-left: 13px; padding-right: 13px; }
    }
  </style>
</head>
<body>
  
  <!-- Navbar presisi, tetap konsisten seperti di index.html -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
    <div class="container" style="max-width:920px;">
      <a class="navbar-brand" href="index.html">Sodikin</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navMain" aria-controls="navMain" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navMain">
        <ul class="navbar-nav ml-auto align-items-lg-center">
          <li class="nav-item"><a class="nav-link" href="index.html#home"><i class="fas fa-house-user d-inline-block mr-1"></i> Beranda</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#projects"><i class="fas fa-layer-group d-inline-block mr-1"></i> Projects</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#contact"><i class="fas fa-envelope-open-text d-inline-block mr-1"></i> Kontak</a></li>
          <li class="nav-item"><a class="nav-link active" href="./blog.html"><i class="fas fa-blog d-inline-block mr-1"></i> Blog</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Blog header selalu tampil, konsisten -->
  <header class="blog-header">
    <div class="container" style="max-width:920px;">
      <div class="blog-title"><i class="fas fa-blog mr-1"></i> Blog Sodikin</div>
      <div class="blog-desc">Kumpulan artikel sederhana, catatan coding, dan sharing insight teknologi dari Sodikin.</div>
    </div>
  </header>

  <main id="main">
    <div id="list-view" style="display:none;">
      <div class="d-flex flex-wrap justify-content-between align-items-center mb-3">
        <h2 class="blog-h2 mb-0"><i class="fas fa-newspaper mr-1"></i> Daftar Artikel</h2>
        <input id="search" placeholder="Cari judul atau deskripsi..." />
      </div>
      <div id="cards" class="grid"></div>
    </div>

    <div id="article-view" style="display:none;">
      <a class="back mb-3" href="#" id="back-link"><i class="fas fa-arrow-left mr-2"></i> Kembali ke daftar</a>
      <div id="article" class="article-content" ></div>
    </div>

    <div id="msg" style="margin-top:20px;"></div>
  </main>

  <!-- ===== CONTACT / FOOTER SECTION ===== -->
  <footer id="contact" class="bg-primary text-white py-5 mt-5">
      <div class="container">
        <div class="row align-items-center mb-4">
          <div class="col-md-7 mb-3 mb-md-0">
            <h3 class="font-weight-bold mb-2">Hubungi Saya</h3>
            <p class="mb-2">Email: <a href="mailto:Sodikin@gmail.com" class="text-white font-weight-bold">Sodikin@gmail.com</a></p>
            <p class="mb-1 d-inline-block mr-2"><a href="https://wa.me/6281234567890" class="text-white"><i class="fab fa-whatsapp mr-1"></i> WhatsApp</a></p>
            <p class="mb-1 d-inline-block"><a href="https://linkedin.com/in/Sodikin" class="text-white"><i class="fab fa-linkedin mr-1"></i> LinkedIn</a></p>
          </div>
          <div class="col-md-5 text-md-right">
            <form style="max-width:345px;margin-left:auto;">
              <div class="form-group mb-2">
                <input type="text" class="form-control" placeholder="Nama" required>
              </div>
              <div class="form-group mb-2">
                <input type="email" class="form-control" placeholder="Email" required>
              </div>
              <div class="form-group mb-2">
                <textarea class="form-control" rows="2" placeholder="Pesan..." required></textarea>
              </div>
              <button type="submit" class="btn btn-light btn-block font-weight-bold">Kirim Pesan</button>
            </form>
          </div>
        </div>
        <hr class="border-light opacity-50" />
        <div class="text-center text-white-50 small">© 2024 Sodikin • Portfolio UI/UX • Dibuat dengan <i class="fas fa-heart text-danger"></i></div>
      </div>
  </footer>

  <!-- Bootstrap JS, Popper, jQuery -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>

<script>
const fallbackArticles = [
  { slug: "sample-article", title: "Contoh Artikel", date: "2025-10-29", desc: "Ini contoh artikel yang dimuat dari file markdown." }
];
function escapeHtml(s){
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}
function mdToHtml(md){
  md = md.replace(/\r\n/g, '\n');
  const lines = md.split('\n');
  let out = [];
  let inCode = false;
  let codeLang = '';
  let inList = false;
  function closeList(){ if(inList){ out.push('</ul>'); inList=false; } }
  for(let i=0;i<lines.length;i++){
    let line = lines[i];
    const fence = line.match(/^```(\w+)?/);
    if(fence){
      if(!inCode){
        inCode = true; codeLang = fence[1] || '';
        out.push('<pre><code class="lang-'+escapeHtml(codeLang)+'">');
      } else {
        inCode = false; out.push('</code></pre>');
      }
      continue;
    }
    if(inCode){
      out.push(escapeHtml(line)+'\n');
      continue;
    }
    if(/^#{1,6}\s+/.test(line)){
      closeList();
      const level = line.match(/^#{1,6}/)[0].length;
      const text = line.replace(/^#{1,6}\s+/,'');
      out.push(`<h${level}>${inlineMd(text)}</h${level}>`);
      continue;
    }
    if(/^\s*[-+*]\s+/.test(line)){
      if(!inList){ inList=true; out.push('<ul>'); }
      const item = line.replace(/^\s*[-+*]\s+/,'');
      out.push('<li>'+inlineMd(item)+'</li>');
      continue;
    } else {
      closeList();
    }
    if(/^\s*([-*_]){3,}\s*$/.test(line)){
      out.push('<hr/>'); continue;
    }
    if(line.trim()===''){
      out.push(''); continue;
    }
    out.push('<p style="text-align:justify; padding: 6px; margin: 6px;">'+inlineMd(line)+'</p>');
  }
  closeList();
  return out.join('\n');
}
function inlineMd(text){
  text = escapeHtml(text);

  // 🖼️ Gambar: ![alt](url)
  text = text.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, (m, alt, src) => {
    const url = src.replace(/"/g, '').trim();
    const altText = alt.replace(/"/g, '&quot;');
    return `<img src="${url}" alt="${altText}" style="max-width:100%;border-radius:10px;margin:14px 0;">`;
  });

  // 🔗 Link: [text](url)
  text = text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, (m, t, u) => {
    const url = u.replace(/"/g,'').trim();
    return `<a href="${url}" target="_blank" rel="noopener">${t}</a>`;
  });

  // 💻 Inline code
  text = text.replace(/`([^`]+)`/g, '<code class="inline">$1</code>');

  // 🔤 Bold dan italic
  text = text.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
  text = text.replace(/__([^_]+)__/g, '<strong>$1</strong>');
  text = text.replace(/\*([^*]+)\*/g, '<em>$1</em>');
  text = text.replace(/_([^_]+)_/g, '<em>$1</em>');

  return text;
}

async function loadIndex(){
  try{
    const res = await fetch('index.json', {cache: "no-store"});
    if(!res.ok) throw new Error('index.json not found');
    const data = await res.json();
    if(!Array.isArray(data)) throw new Error('index.json harus array');
    return data;
  }catch(err){
    console.warn('index.json load failed:', err);
    return fallbackArticles;
  }
}

// Menyimpan index artikel di sini agar bisa diakses ketika menampilkan artikel
let cachedIndexArticles = null;

function renderList(articles){
  cachedIndexArticles = articles; // Simpan index artikel global/cache
  document.getElementById('article-view').style.display='none';
  const list = document.getElementById('list-view');
  list.style.display='block';
  const cards = document.getElementById('cards');
  cards.innerHTML='';
  for(const a of articles){
    const div = document.createElement('div');
    div.className='card blog-card';
    div.innerHTML = `<a class="article-link" href="#article/${a.slug}">
      <div class="blog-card-body">
        <h3 style="margin:0 0 9px;font-weight:600">${escapeHtml(a.title)}</h3>
        <div class="meta">
          <i class="fas fa-calendar-alt mr-1"></i> ${escapeHtml(a.date || '')}
          ${a.desc ? '&nbsp;·&nbsp;<span>'+escapeHtml(a.desc)+'</span>' : ''}
        </div>
      </div>
      <div class="blog-card-footer">
        <span class="blog-card-read">Baca Artikel <i class="fa fa-arrow-right ml-1"></i></span>
      </div>
    </a>`;
    cards.appendChild(div);
  }
  const search = document.getElementById('search');
  search.oninput = (e)=>{
    const q = e.target.value.toLowerCase().trim();
    const filtered = articles.filter(x => (x.title||'').toLowerCase().includes(q) || (x.desc||'').toLowerCase().includes(q));
    cards.innerHTML='';
    for(const a of filtered){
      const div = document.createElement('div');
      div.className='card blog-card';
      div.innerHTML = `<a class="article-link" href="#article/${a.slug}">
        <div class="blog-card-body">
          <h3 style="margin:0 0 8px;font-weight:600">${escapeHtml(a.title)}</h3>
          <div class="meta">
            <i class="fas fa-calendar-alt mr-1"></i> ${escapeHtml(a.date||'')}
            ${a.desc?'&nbsp;·&nbsp;<span>'+escapeHtml(a.desc)+'</span>':''}
          </div>
        </div>
        <div class="blog-card-footer">
          <span class="blog-card-read">Baca Artikel <i class="fa fa-arrow-right ml-1"></i></span>
        </div>
      </a>`;
      cards.appendChild(div);
    }
  };
}

async function renderArticle(slug) {
  document.getElementById('list-view').style.display = 'none';
  document.getElementById('article-view').style.display = 'block';
  const articleEl = document.getElementById('article');
  articleEl.innerHTML = '<p>Memuat artikel…</p>';

  // Coba dapatkan meta desc dari index article yang sudah dicache
  let artikelDesc = null;
  if (cachedIndexArticles && cachedIndexArticles.length > 0) {
    const matched = cachedIndexArticles.find(a => a.slug === slug);
    if (matched && matched.desc) {
      artikelDesc = matched.desc;
    }
  }

  try {
    const res = await fetch(`articles/${slug}.md`, { cache: "no-store" });
    if (!res.ok) throw new Error('Artikel tidak ditemukan');
    const md = await res.text();
    const match = md.match(/^#\s+(.+)/m);
    const title = match ? match[1].trim() : slug;
    document.title = title + " | Blog Sodikin";

    // Update isi/header blog-title jika ada, tapi header tidak pernah hilang
    var titleContainer = document.querySelector('header.blog-header .blog-title');
    if (titleContainer) {
      titleContainer.textContent = title;
    }

    // Set meta description tag jika ada
    var metaDescTag = document.querySelector('meta[name="description"]#meta-desc');
    if (metaDescTag) {
      if (artikelDesc) {
        metaDescTag.setAttribute('content', artikelDesc);
      } else {
        metaDescTag.setAttribute('content', 'Kumpulan artikel sederhana, catatan coding, dan sharing insight teknologi dari Sodikin.');
      }
    }

    const html = mdToHtml(md);
    articleEl.innerHTML = html;
    window.scrollTo(0, 0);
  } catch (err) {
    articleEl.innerHTML = `
      <div class="notfound">
        <strong>Error:</strong> Gagal memuat "${slug}.md".
        <div style="margin-top:8px;color:#9b1c1c99">${escapeHtml(err.message)}</div>
      </div>`;
    // fallback pada error: reset ke meta description default
    var metaDescTag = document.querySelector('meta[name="description"]#meta-desc');
    if (metaDescTag) {
      metaDescTag.setAttribute('content', 'Kumpulan artikel sederhana, catatan coding, dan sharing insight teknologi dari Sodikin.');
    }
  }
}
async function init(){
  const idx = await loadIndex();
  renderList(idx);

  function handleHash(){
    const hash = location.hash || '';
    if(hash.startsWith('#article/')){
      const slug = hash.replace('#article/','').trim();
      renderArticle(slug);
    } else {
      document.getElementById('article-view').style.display = 'none';
      document.getElementById('list-view').style.display = 'block';
      document.title = "Blog | Sodikin";
      // — Tidak pernah menghilangkan blog header, hanya reset text
      var titleContainer = document.querySelector('header.blog-header .blog-title');
      if (titleContainer) {
        titleContainer.innerHTML = '<i class="fas fa-blog mr-1"></i> Blog Sodikin';
      }
      // reset meta description ke default jika kembali ke daftar
      var metaDescTag = document.querySelector('meta[name="description"]#meta-desc');
      if (metaDescTag) {
        metaDescTag.setAttribute('content', 'Kumpulan artikel sederhana, catatan coding, dan sharing insight teknologi dari Sodikin.');
      }
    }
  }
  window.addEventListener('hashchange', handleHash);
  document.getElementById('back-link').addEventListener('click', (e)=>{
    e.preventDefault();
    location.hash = '';
  });
  handleHash();
}
init();
</script>
</body>
</html>
